---
import GuideLayout from "../../layouts/GuideLayout.astro";

const title = "WAF cost optimization (reduce requests + rule sprawl)";
const description =
  "A practical playbook to reduce WAF spend: cut evaluated requests, keep rule count tight, and avoid downstream logging waste.";
---
<GuideLayout
  title={title}
  description={description}
  canonicalPath="/guides/aws-waf-cost-optimization"
  lastUpdated="2026-01-27"
  faqs={[
    {
      q: "What's the biggest lever for WAF cost?",
      a: "Reducing evaluated requests (especially during spikes) and controlling downstream logging volume. Baseline ACL/rule fees are usually smaller.",
    },
    {
      q: "Can security logging cost more than WAF?",
      a: "Yes. If you stream all WAF logs into log storage and run frequent searches, storage and scan/query costs can exceed the WAF line item.",
    },
    {
      q: "Is blocking more traffic always cheaper?",
      a: "Not automatically. You need to reduce evaluated requests and avoid expensive downstream processing. The goal is fewer evaluations and fewer noisy logs while keeping security outcomes intact.",
    },
  ]}
>
  <p>
    Most WAF savings come from reducing the <strong>volume</strong> and the <strong>blast radius</strong> of evaluated
    requests, and from avoiding rule/ACL sprawl across many apps and environments.
  </p>

  <h2>What to model (WAF + the hidden log bill)</h2>
  <ul>
    <li>
      <strong>Requests evaluated</strong>: baseline and peak (attacks and bot waves are the peak)
    </li>
    <li>
      <strong>Rules/ACL sprawl</strong>: duplicated policies across environments increase baseline cost and maintenance risk
    </li>
    <li>
      <strong>Logging volume</strong>: shipping every request to logs can be more expensive than the WAF line item itself
    </li>
  </ul>

  <h2>1) Reduce evaluated requests</h2>
  <ul>
    <li>Cache aggressively at the CDN for cacheable routes.</li>
    <li>Rate-limit abusive traffic early (before it fans out).</li>
    <li>Block obvious bot paths and noisy endpoints (login, search) with targeted rules.</li>
  </ul>
  <p class="muted">
    Think in terms of "requests you never evaluate" (blocked earlier or served from cache) vs "requests you evaluate but allow".
  </p>

  <h2>2) Keep ACLs and rules tight</h2>
  <ul>
    <li>Consolidate similar policies; avoid duplicating ACLs per microservice without need.</li>
    <li>Remove unused rules and overly broad managed rule sets.</li>
  </ul>
  <ul>
    <li>Prefer a small number of shared, well-owned ACL templates rather than copy/paste per environment.</li>
    <li>Review rule changes after incidents; temporary emergency rules tend to accumulate into permanent cost.</li>
  </ul>

  <h2>3) Control downstream logging/analysis</h2>
  <ul>
    <li>Sample or filter logs for noisy paths if you don't need full fidelity.</li>
    <li>Set retention intentionally; avoid storing everything forever.</li>
    <li>Optimize queries to avoid repeated full scans.</li>
  </ul>
  <p class="muted">
    If you need detailed investigation, consider targeted logging for specific rules or short windows, rather than always-on full-fidelity logs.
  </p>

  <h2>4) Quantify changes (baseline + attack scenario)</h2>
  <p>
    Use <a href="/calculators/aws-waf-cost-calculator/">WAF Cost Calculator</a> to estimate savings from reducing rule
    count or request volume.
  </p>
  <ul>
    <li>Baseline scenario: typical daily request volume and current rule count.</li>
    <li>Peak scenario: attack window request volume (and expected logging intensity).</li>
    <li>Compare: WAF vs log storage/search costs if you enable full logging.</li>
  </ul>

  <h2>Common pitfalls</h2>
  <ul>
    <li>Optimizing the WAF line item while ignoring the logging and analysis bill.</li>
    <li>Using one "average month" and missing attack spikes (the peak is the real risk).</li>
    <li>Rule sprawl: many similar ACLs across apps and environments with no ownership.</li>
    <li>Caching disabled on routes that could be cached, forcing every request through WAF evaluation.</li>
    <li>Over-logging noisy endpoints (health checks, bots, scanners) without sampling or filters.</li>
  </ul>

  <h2>How to validate the optimization</h2>
  <ul>
    <li>Reconcile evaluated requests and rule counts against the bill in Cost Explorer / CUR.</li>
    <li>Compare baseline vs peak windows (incidents, bot waves) and keep the peak scenario in your budget.</li>
    <li>Validate security outcomes: false positives/negatives should not worsen after cost optimizations.</li>
  </ul>

  <h2>Related guides</h2>
  <div class="btn-row">
    <a class="btn" href="/guides/aws-waf-estimate-requests/">Estimate WAF requests</a>
    <a class="btn" href="/guides/aws-waf-cost-spikes-during-attacks/">WAF cost spikes during attacks</a>
    <a class="btn" href="/guides/aws-waf-vs-cloudflare-waf-cost/">AWS WAF vs Cloudflare WAF cost</a>
  </div>

  <h2>Sources</h2>
  <ul>
    <li>
      <a href="https://aws.amazon.com/waf/pricing/" target="_blank" rel="nofollow noopener">
        AWS WAF pricing
      </a>
    </li>
    <li>
      <a href="https://docs.aws.amazon.com/waf/latest/developerguide/logging.html" target="_blank" rel="nofollow noopener">
        AWS WAF logging
      </a>
    </li>
  </ul>

</GuideLayout>
