---
import GuideLayout from "../../layouts/GuideLayout.astro";

const title = "Cloud Armor pricing (GCP): model baseline traffic, attack spikes, and logging";
const description =
  "A practical Cloud Armor estimate: baseline request volume plus an attack scenario (peak RPS × duration). Includes validation steps for spikes, rule footprint, and the secondary cost driver most teams miss: logs and analytics during incidents.";

const faqs = [
  {
    q: "What usually drives WAF cost?",
    a: "Request volume is the main driver. Attack traffic (bots, DDoS) can multiply requests and create cost spikes if you don’t budget a peak scenario.",
  },
  {
    q: "How do I estimate quickly?",
    a: "Estimate monthly requests at baseline, then add an incident scenario (peak RPS × hours/days). Keep WAF request costs separate from CDN request fees and origin request costs.",
  },
  {
    q: "Why do WAF bills spike during incidents?",
    a: "Because incident traffic often increases request volume by 2–10×. If you also enable verbose logging during the incident, log ingestion becomes a second spike.",
  },
  {
    q: "How do I validate?",
    a: "Validate baseline and peak RPS from analytics, validate what you log (all requests vs blocked only), and validate whether you are double-counting requests across layers (CDN + WAF + origin).",
  },
];
---
<GuideLayout
  title={title}
  description={description}
  canonicalPath="/guides/gcp-cloud-armor-pricing"
  lastUpdated="2026-01-27"
  faqs={faqs}
>
  <p>
    WAF pricing is a request-volume problem with tail risk. A good model includes two scenarios: <strong>baseline</strong>{" "}
    traffic and an <strong>incident</strong> spike. If you only model baseline, the bill will surprise you exactly when you
    are under attack.
  </p>

  <h2>0) Define the layer (where Cloud Armor sits)</h2>
  <p>
    Make sure you understand which requests Cloud Armor sees: edge traffic, load balancer traffic, or a subset by hostname
    and path. This prevents double counting.
  </p>
  <ul>
    <li>
      <strong>CDN requests</strong>: counted at the CDN edge.
    </li>
    <li>
      <strong>WAF requests</strong>: counted where the WAF is enforced (often at the edge/load balancer).
    </li>
    <li>
      <strong>Origin requests</strong>: what reaches your backend after caching and filtering.
    </li>
  </ul>
  <p class="muted">
    Guide: <a href="/guides/cdn-request-pricing/">CDN request pricing</a>.
  </p>

  <h2>1) Baseline request volume (requests/month)</h2>
  <p>
    Convert baseline RPS to monthly requests. If your traffic is seasonal, model the high-traffic month rather than the
    average month.
  </p>
  <p class="muted">
    Tool: <a href="/calculators/rps-to-monthly-requests-calculator/">RPS to monthly requests</a>.
  </p>

  <h2>2) Incident scenario (peak RPS × duration)</h2>
  <p>
    Budget an incident scenario: peak RPS multiplied by hours or days. This captures bot surges and DDoS windows. If you do
    not have history, choose a conservative multiplier (e.g., 5× baseline for 24–72 hours) and refine later.
  </p>
  <ul>
    <li>
      <strong>Peak requests</strong> ~= peak RPS × 86,400 × days
    </li>
    <li>
      Keep incident traffic as a separate line item, not blended into baseline.
    </li>
  </ul>

  <h2>3) Logging and analytics (the hidden second bill)</h2>
  <p>
    Logging is often the second spike driver. If you log every request during an incident, log ingestion can become material
    even when WAF request pricing is acceptable.
  </p>
  <p class="muted">
    Tools: <a href="/calculators/log-ingestion-cost-calculator/">Log ingestion</a>,{" "}
    <a href="/calculators/log-storage-cost-calculator/">Tiered log storage</a>,{" "}
    <a href="/calculators/log-search-scan-cost-calculator/">Log scan</a>.
  </p>
  <ul>
    <li>
      Decide whether you log <strong>all requests</strong>, <strong>blocked only</strong>, or a sampled subset.
    </li>
    <li>
      Model retention separately (hot window + archive) so incident logs do not create a long-term bill.
    </li>
  </ul>

  <h2>Worked estimate template (copy/paste)</h2>
  <ul>
    <li>
      <strong>Baseline requests/month</strong> = baseline RPS × 86,400 × days
    </li>
    <li>
      <strong>Incident requests</strong> = peak RPS × 86,400 × incident days
    </li>
    <li>
      <strong>Logs</strong> = requests × bytes/request (baseline + incident), then retention + scan if applicable
    </li>
  </ul>

  <h2>Common pitfalls</h2>
  <ul>
    <li>Modeling baseline only and ignoring attack spikes.</li>
    <li>Double-counting requests across CDN + WAF + origin layers.</li>
    <li>Turning on verbose logging during incidents without modeling ingestion and retention.</li>
    <li>Using one blended request volume that hides a short but expensive attack window.</li>
    <li>Not validating what is actually logged (all vs blocked vs sampled).</li>
  </ul>

  <h2>How to validate</h2>
  <ul>
    <li>Validate baseline and peak RPS from historical analytics or load balancer metrics.</li>
    <li>Validate incident duration assumptions (hours vs days) using real timelines.</li>
    <li>Validate logging strategy and retention (do not keep incident noise forever).</li>
    <li>After changes, validate that request and log volumes move in the expected direction.</li>
  </ul>

  <h2>Related tools</h2>
  <div class="btn-row">
    <a class="btn" href="/calculators/rps-to-monthly-requests-calculator/">Requests/month</a>
    <a class="btn" href="/calculators/cdn-request-cost-calculator/">CDN request fees</a>
    <a class="btn" href="/calculators/log-cost-calculator/">Logs</a>
    <a class="btn" href="/guides/request-based-pricing/">Request-based pricing</a>
  </div>

  <h2>Sources</h2>
  <ul>
    <li>
      <a href="https://cloud.google.com/armor/pricing" target="_blank" rel="nofollow noopener">
        Cloud Armor pricing
      </a>
    </li>
    <li>
      <a href="https://cloud.google.com/armor/docs" target="_blank" rel="nofollow noopener">
        Cloud Armor documentation
      </a>
    </li>
  </ul>
</GuideLayout>

