---
import GuideLayout from "../../layouts/GuideLayout.astro";

const title = "WAF cost spikes during attacks: how to budget request surges";
const description =
  "A practical guide to WAF cost spikes during attacks: why request-based charges jump, how to model surge traffic, and how to reduce evaluated requests and logging volume safely.";
const faqs = [
  {
    q: "Why do WAF bills spike during incidents?",
    a: "Because WAF pricing often includes request-based charges. Attack traffic (even if blocked) is still evaluated and can multiply request volume and downstream logging cost.",
  },
  {
    q: "Should I budget blocked requests?",
    a: "Yes. For cost models, use evaluated requests (allowed + blocked). During bot spikes, blocked traffic can dominate request counts.",
  },
  {
    q: "What's the fastest way to estimate surge cost?",
    a: "Estimate your steady monthly requests, then model a surge scenario (for example, 10x RPS for 6 hours/day for 3 days) and convert it into additional monthly requests.",
  },
];
---
<GuideLayout
  title={title}
  description={description}
  canonicalPath="/guides/aws-waf-cost-spikes-during-attacks"
  lastUpdated="2026-01-27"
  faqs={faqs}
>
  <p>
    WAF cost spikes are usually not caused by \"more rules\" - they're caused by <strong>more evaluated requests</strong>.
    During attacks, blocked traffic can explode request volume and create an additional surprise: <strong>security log
    cost</strong> can grow with it.
  </p>

  <h2>Step 1: separate steady traffic from surge traffic</h2>
  <ul>
    <li><strong>Steady</strong>: your typical 30-day traffic.</li>
    <li><strong>Surge</strong>: bot spikes, credential stuffing, scraping, or DDoS-like bursts.</li>
    <li><strong>Include blocked traffic</strong>: for billing, it's often evaluated even when blocked.</li>
  </ul>

  <h2>Step 2: convert surge RPS into added monthly requests</h2>
  <p class="muted">
    Simple approximation: <strong>extra requests = surge RPS x surge seconds</strong>. Then add to your steady
    requests/month.
  </p>
  <ul>
    <li>
      Keep two scenarios: <strong>baseline</strong> (typical month) and <strong>attack</strong> (surge traffic for a few hours/days).
    </li>
    <li>
      Include <strong>blocked</strong> and <strong>allowed</strong> requests together (evaluated requests).
    </li>
  </ul>
  <div class="btn-row">
    <a class="btn" href="/guides/aws-waf-estimate-requests/">Estimate WAF requests</a>
    <a class="btn" href="/calculators/rps-to-monthly-requests-calculator/">RPS to monthly requests</a>
  </div>

  <h2>Worked surge example (copy/paste)</h2>
  <ul>
    <li>
      <strong>Baseline</strong>: 500 RPS sustained -&gt; convert to monthly requests.
    </li>
    <li>
      <strong>Attack</strong>: +5,000 RPS for 6 hours/day for 3 days -&gt; extra requests = 5,000 * (6 * 3600) * 3.
    </li>
    <li>
      <strong>Total</strong>: baseline monthly + extra attack requests.
    </li>
  </ul>
  <p class="muted">
    The purpose is not perfect math; it is to avoid budgeting only the steady state and getting surprised by the peak.
  </p>

  <h2>Step 3: reduce evaluated requests (high leverage)</h2>
  <ul>
    <li><strong>Cache</strong> aggressively for cacheable routes (especially for abusive hot paths).</li>
    <li><strong>Rate-limit</strong> early for known abusive endpoints (login, search, auth token endpoints).</li>
    <li><strong>Block</strong> obvious bot paths and bad user agents with targeted rules.</li>
    <li><strong>Move traffic up</strong> the stack: stop bad traffic at the CDN edge when possible.</li>
  </ul>
  <ul>
    <li>
      Use a <strong>narrow allowlist</strong> for truly public endpoints during incidents (reduce evaluation surface).
    </li>
    <li>
      Keep <strong>one high-confidence emergency policy</strong> ready (temporary controls tend to become permanent if you do not review them).
    </li>
  </ul>

  <h2>Step 4: don't let security logging become the bigger bill</h2>
  <ul>
    <li>Sample or filter logs for high-volume endpoints where full fidelity isn't required.</li>
    <li>Set retention intentionally for noisy logs.</li>
    <li>Optimize queries and dashboards to avoid repeated large scans.</li>
  </ul>
  <p class="muted">
    If you need detailed investigation, prefer targeted logging for specific rules or short windows instead of always-on full-fidelity logs.
  </p>

  <h2>How to validate after an attack</h2>
  <ul>
    <li>Reconcile evaluated requests (allowed + blocked) against the WAF bill for the same window.</li>
    <li>Compare baseline days vs attack days and keep the peak scenario for future budgets.</li>
    <li>Check whether logging and dashboards caused repeated scans of large windows during incident response.</li>
  </ul>

  <h2>Related tools</h2>
  <div class="btn-row">
    <a class="btn" href="/calculators/aws-waf-cost-calculator/">WAF cost calculator</a>
    <a class="btn" href="/guides/aws-waf-pricing/">WAF pricing</a>
    <a class="btn" href="/guides/aws-waf-cost-optimization/">WAF cost optimization</a>
  </div>

  <h2>Validation checklist</h2>
  <ul>
    <li>Validate the primary driver with measured usage from a representative window.</li>
    <li>Confirm units and pricing units (per 10k vs per 1M, GB vs GiB) before trusting the estimate.</li>
    <li>Re-check incident windows: retries/timeouts often multiply cost drivers.</li>
  </ul>

  <h2>Related reading</h2>
  <div class="btn-row">
    <a class="btn" href="/guides/cloud-cost-estimation-checklist/">Cost estimation checklist</a>
    <a class="btn" href="/guides/network-transfer-costs/">Network transfer costs</a>
    <a class="btn" href="/guides/request-based-pricing/">Request-based pricing</a>
  </div>

  <h2>Sources</h2>
  <ul>
    <li>
      <a href="https://aws.amazon.com/waf/pricing/" target="_blank" rel="nofollow noopener">
        AWS WAF pricing
      </a>
    </li>
    <li>
      <a href="https://docs.aws.amazon.com/waf/latest/developerguide/logging.html" target="_blank" rel="nofollow noopener">
        AWS WAF logging
      </a>
    </li>
  </ul>

</GuideLayout>
